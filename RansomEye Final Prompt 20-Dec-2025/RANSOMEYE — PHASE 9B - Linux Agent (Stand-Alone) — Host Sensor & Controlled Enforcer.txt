# ğŸ§ RANSOMEYE â€” PHASE 9B

## Linux Agent (Stand-Alone) â€” Host Sensor & Controlled Enforcer

### **(AUTHORITATIVE MASTER PROMPT â€“ PHASE 9B)**

**Environment Root:** `/home/ransomeye/rebuild/`
**Phase Folder:** `/home/ransomeye/rebuild/ransomeye_linux_agent/`

---

## CONTEXT (ENDPOINT TRUST BOUNDARY)

The Linux Agent operates **on potentially compromised hosts** and must assume:

* Hostile local users
* Partial privilege loss
* Kernel feature variability
* Offline / air-gapped operation

This agent is **stand-alone** and:

* Collects host-level telemetry
* Executes **only explicitly authorized enforcement**
* Never correlates across hosts
* Never infers attacks
* Never depends on AI to function

---

## ğŸš¨ GLOBAL RULES (RE-ENFORCED)

All rules from **Phase 1â€“8** apply unchanged.

Additional Phase-9B rules below are **hard enforcement**.

---

## ğŸ¯ PHASE 9B OBJECTIVE

Build a **minimal-footprint, Linux-agnostic, cryptographically controlled Linux Agent** that:

1. Collects host telemetry safely
2. Normalizes and signs telemetry events
3. Receives **signed enforcement directives only**
4. Executes enforcement safely and reversibly
5. Maintains strong identity and integrity
6. Operates without swap
7. Works across **any Linux distribution** (no assumptions)

---

## ğŸš« LANGUAGE & LICENSE RULES (STRICT)

### Allowed Languages

* **Rust (PRIMARY)**
* **C (ONLY if kernel interaction is unavoidable)**

### Forbidden

* Python
* Go
* Java
* NodeJS
* Shell as core logic
* GPL userland libraries

All dependencies must be **MIT / BSD / Apache 2.0**.

---

## ğŸ’¾ SWAP POLICY (EXPLICIT)

* **Swap usage is FORBIDDEN**
* Agent must not create, require, or depend on swap
* Memory usage must be bounded
* Swap checks must explicitly skip Linux Agent

---

## ğŸ“¦ RESPONSIBILITY BOUNDARIES (STRICT)

### MUST DO

* Process activity telemetry
* File system metadata telemetry
* System integrity signals
* Kernel / OS metadata capture
* Secure communication with Core ingestion
* Signed enforcement execution
* Self-integrity verification

### MUST NEVER DO

* Policy decisions
* Cross-host correlation
* AI inference
* Runtime learning
* Unsigned execution
* OS destabilization

---

## ğŸ“ PHASE 9B DIRECTORY STRUCTURE (MANDATORY)

Create exactly:

```
/home/ransomeye/rebuild/ransomeye_linux_agent/
```

```
ransomeye_linux_agent/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.rs
â”‚   â”œâ”€â”€ agent.rs
â”‚   â”œâ”€â”€ lifecycle.rs
â”‚   â”œâ”€â”€ telemetry/
â”‚   â”‚   â”œâ”€â”€ process.rs
â”‚   â”‚   â”œâ”€â”€ filesystem.rs
â”‚   â”‚   â”œâ”€â”€ memory.rs
â”‚   â”‚   â”œâ”€â”€ kernel.rs
â”‚   â”‚   â””â”€â”€ system.rs
â”‚   â”‚
â”‚   â”œâ”€â”€ enforcement/
â”‚   â”‚   â”œâ”€â”€ actions.rs
â”‚   â”‚   â”œâ”€â”€ safeguards.rs
â”‚   â”‚   â””â”€â”€ rollback.rs
â”‚   â”‚
â”‚   â”œâ”€â”€ comms/
â”‚   â”‚   â”œâ”€â”€ protocol.rs
â”‚   â”‚   â”œâ”€â”€ encryption.rs
â”‚   â”‚   â””â”€â”€ retry.rs
â”‚   â”‚
â”‚   â”œâ”€â”€ security/
â”‚   â”‚   â”œâ”€â”€ identity.rs
â”‚   â”‚   â”œâ”€â”€ verification.rs
â”‚   â”‚   â””â”€â”€ integrity.rs
â”‚   â”‚
â”‚   â”œâ”€â”€ system/
â”‚   â”‚   â””â”€â”€ env_validation.rs
â”‚   â”‚
â”‚   â””â”€â”€ errors/
â”‚       â””â”€â”€ agent_errors.rs
â”‚
â”œâ”€â”€ systemd/
â”‚   â””â”€â”€ ransomeye-linux-agent.service
â”‚
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ telemetry_model.md
â”‚   â”œâ”€â”€ enforcement_model.md
â”‚   â”œâ”€â”€ kernel_compatibility.md
â”‚   â”œâ”€â”€ security_model.md
â”‚   â””â”€â”€ failure_modes.md
â”‚
â””â”€â”€ tests/
    â”œâ”€â”€ synthetic_telemetry.rs
    â”œâ”€â”€ enforcement_safety_tests.rs
    â”œâ”€â”€ rollback_tests.rs
    â”œâ”€â”€ tamper_tests.rs
    â””â”€â”€ offline_mode_tests.rs
```

---

## ğŸ” IDENTITY & TRUST (MANDATORY)

You MUST enforce:

* Unique per-agent cryptographic identity
* Secure enrollment bootstrap
* Mutual authentication with Core ingestion
* Signature verification on every directive
* Identity expiration and revocation

Verification failure â†’ **REFUSE EXECUTION**

---

## ğŸ“Š TELEMETRY MODEL (SAFE & BOUNDED)

Telemetry MUST be:

* Metadata-only
* Rate-limited
* Privacy-aware
* Schema-validated
* Signed before transmission

No raw file contents
No credential material
No memory dumps

---

## ğŸ›¡ï¸ ENFORCEMENT MODEL (STRICT & SAFE)

Enforcement actions MUST be:

* Explicit
* Signed
* Scoped
* Time-bounded
* Reversible

Agent MUST refuse:

* Unsigned directives
* Over-broad scope
* Unsafe operations
* Missing rollback instructions

---

## ğŸ” AI / ML / LLM INTERACTION (ADVISORY ONLY)

Linux Agent:

* **Does NOT run AI**
* **Does NOT infer**
* **Does NOT score**

Allowed:

* Emit telemetry fields required by AI later
* Receive human-visible context (never actions)

---

## ğŸ’¥ FAILURE MODES (MANDATORY)

Define explicit behavior for:

* Kernel feature unavailable
* Privilege loss
* Disk full
* Network isolation
* Identity expiration
* Binary tampering

Agent must:

* Remain observable
* Avoid OS instability
* Fail safely without blocking host

---

## ğŸ§ª VALIDATION REQUIREMENTS

You MUST include tests that:

* Validate Linux distro neutrality
* Validate no-swap enforcement
* Validate signed enforcement only
* Validate rollback correctness
* Validate offline operation

---

## ğŸ›‘ FAILURE CONDITIONS (HARD)

Phase 9B is INVALID if:

* Swap is used
* Python exists
* Enforcement is implicit
* Identity trust is assumed
* Kernel assumptions exist
* Unsigned actions execute

---

## FINAL INSTRUCTION

Treat the Linux Agent as:

* A **low-trust execution surface**
* A **high-integrity sensor**
* A **surgical enforcer**

If the Linux Agent fails, **it must not damage the host**.

**BUILD PHASE 9B COMPLETELY, EXPLICITLY, AND WITHOUT ASSUMPTIONS.**

---

