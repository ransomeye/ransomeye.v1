# ğŸ§  RANSOMEYE â€“ PHASE 1

## System Architecture, Data Flow & Trust Boundary Design

**(MASTER PROMPT â€“ CURSOR EXECUTION)**

---

## CONTEXT (NON-NEGOTIABLE)

You are continuing the **ground-up rebuild of RansomEye**.

Phase 0 established **legal, security, and governance enforcement**.
Phase 1 defines **how the entire system works before a single functional line of code is written**.

This phase is **pure architecture** â€” but it must be **implementation-aware** and **scale-accurate**.

RansomEye must support:

* **50,000+ endpoints**
* **Multiple DPI Probes**
* **Sustained 40+ Gbps traffic**
* **Air-gapped deployments**
* **Fail-closed security posture**
* **Commercial closed-source distribution**

---

## ğŸš¨ GLOBAL HARD RULES (REPEAT & ENFORCE)

These rules are inherited from Phase 0 and **cannot be weakened**:

* GPL / AGPL / unknown licenses are banned
* ENV-only configuration
* Mandatory file headers everywhere
* No Python on hot path
* No assumptions
* Linux-agnostic design
* Static binaries preferred
* Fail-closed on uncertainty
* No sample data
* AI is advisory unless explicitly stated otherwise

---

## ğŸ¯ PHASE 1 OBJECTIVE

Define a **complete, enforceable, phase-accurate system architecture** that:

1. Clearly separates **data plane vs control plane**
2. Defines **trust boundaries**
3. Defines **responsibility of each component**
4. Defines **data contracts and flows**
5. Prevents architectural drift in later phases

This architecture will be treated as **binding** for all later phases.

---

## ğŸ“¦ REQUIRED ARCHITECTURAL COMPONENTS

You MUST include and fully define **ALL** of the following:

### 1. DPI Probe

* High-throughput packet processing
* Stateless where possible
* No policy decisions
* No AI
* No persistence beyond buffering

### 2. Core Engine

* Correlation
* Kill-chain inference
* Decision logic
* Policy evaluation
* Trust enforcement

### 3. AI / ML Layer

* Training
* Inference
* Explainability (SHAP)
* LLM summarization
* **NO enforcement authority**

### 4. Agents

* Linux Agent
* Windows Agent
* Telemetry
* Local response actions
* Secure identity

### 5. Control Plane

* APIs
* Configuration distribution
* Health monitoring
* Orchestration

### 6. Reporting & Forensics

* Evidence generation
* Chain of custody
* Export formats

---

## ğŸ“ PHASE 1 FOLDER STRUCTURE (ARCHITECTURAL)

You MUST define and explain the **logical folder structure** (even if empty now):

```
core/
â”œâ”€â”€ architecture/
â”‚   â”œâ”€â”€ data_flow.md
â”‚   â”œâ”€â”€ trust_boundaries.md
â”‚   â”œâ”€â”€ failure_domains.md
â”‚   â”œâ”€â”€ threat_model.md
â”‚   â””â”€â”€ scalability_model.md
â”‚
â”œâ”€â”€ contracts/
â”‚   â”œâ”€â”€ event_schema.md
â”‚   â”œâ”€â”€ telemetry_schema.md
â”‚   â”œâ”€â”€ policy_schema.md
â”‚   â””â”€â”€ identity_schema.md
â”‚
dpi_probe/
â”œâ”€â”€ architecture/
â”‚   â”œâ”€â”€ packet_pipeline.md
â”‚   â”œâ”€â”€ threading_model.md
â”‚   â”œâ”€â”€ memory_model.md
â”‚   â””â”€â”€ kernel_integration.md
â”‚
agents/
â”œâ”€â”€ architecture/
â”‚   â”œâ”€â”€ linux_agent.md
â”‚   â”œâ”€â”€ windows_agent.md
â”‚   â””â”€â”€ response_model.md
â”‚
ai/
â”œâ”€â”€ architecture/
â”‚   â”œâ”€â”€ training_pipeline.md
â”‚   â”œâ”€â”€ inference_pipeline.md
â”‚   â”œâ”€â”€ explainability.md
â”‚   â””â”€â”€ llm_guardrails.md
â”‚
control_plane/
â”œâ”€â”€ architecture/
â”‚   â”œâ”€â”€ api_design.md
â”‚   â”œâ”€â”€ auth_model.md
â”‚   â””â”€â”€ config_distribution.md
```

You must explain **why each folder exists** and **what it forbids**.

---

## ğŸ”€ REQUIRED DATA FLOW DEFINITIONS

You MUST define, in detail:

1. **Packet â†’ Flow â†’ Event**
2. **Event â†’ Correlation**
3. **Correlation â†’ Decision**
4. **Decision â†’ Policy**
5. **Policy â†’ Response**
6. **Decision â†’ AI (read-only)**
7. **AI â†’ Human (SOC)**

Each flow must specify:

* Direction
* Trust level
* Authentication
* Failure behavior
* Backpressure handling

---

## ğŸ” TRUST BOUNDARIES (CRITICAL)

Explicitly define:

* What components trust each other
* What components never trust each other
* Where cryptographic verification is mandatory
* Where fail-closed behavior is enforced

You MUST include:

* DPI â†’ Core trust boundary
* Agent â†’ Core trust boundary
* AI â†’ Core boundary (AI never trusted)
* Control Plane â†’ Core boundary

---

## ğŸ’¥ FAILURE DOMAIN ANALYSIS

You MUST define:

* What happens if DPI Probe crashes
* What happens if Core crashes
* What happens if AI crashes
* What happens if Control Plane crashes
* What happens if connectivity is lost

Include:

* Blast radius
* Recovery behavior
* Data loss tolerance (if any)

---

## âš™ï¸ SCALE & PERFORMANCE MODEL

You MUST model:

* CPU scaling
* Threading assumptions
* NUMA considerations
* Memory growth
* Network throughput
* Backpressure limits

No numbers may be guessed â€” use **relative scaling logic**.

---

## ğŸ§  AI ROLE (STRICT LIMITATION)

You MUST explicitly state:

* AI **cannot**:

  * Enforce policy
  * Block traffic
  * Execute response actions
* AI **can**:

  * Score
  * Explain
  * Summarize
  * Assist humans

This must be enforced architecturally, not by convention.

---

## ğŸ“¤ EXPECTED OUTPUT FORMAT

You must output:

1. High-level architecture explanation
2. Component responsibility matrix
3. Data flow diagrams (ASCII)
4. Trust boundary definitions
5. Failure domain analysis
6. Folder structure explanation
7. Explicit â€œwhat this phase forbidsâ€

---

## ğŸ›‘ FAILURE CONDITIONS

Your output is INVALID if:

* Any component has overlapping responsibility
* Any trust boundary is implicit
* AI is allowed to influence enforcement
* DPI Probe performs policy logic
* Python appears in hot path
* Architecture is â€œconceptualâ€ instead of enforceable

---

## FINAL INSTRUCTION

This architecture is **binding**.

Later phases are **not allowed** to contradict it.

Design this as if:

* It will be audited
* It will be attacked
* It will be scaled to failure

**BUILD PHASE 1 COMPLETELY AND EXPLICITLY.**
