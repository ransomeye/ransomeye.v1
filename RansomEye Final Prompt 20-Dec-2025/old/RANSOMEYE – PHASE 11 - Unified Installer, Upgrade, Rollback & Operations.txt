# âš™ï¸ RANSOMEYE â€“ PHASE 11

## Unified Installer, Upgrade, Rollback & Operations

### **(PROMPT NUMBER 11 OF 12)**

**MASTER PROMPT â€“ CURSOR EXECUTION**

---

## CONTEXT (ENTERPRISE OPERATIONSâ€“CRITICAL)

You are building the **installation, upgrade, rollback, and operational control layer** for RansomEye.

This phase determines:

* How safely RansomEye is deployed
* Whether upgrades can brick environments
* Whether rollbacks are reliable
* Whether air-gapped enterprises can operate the platform

This phase must assume:

* No internet access
* Strict change-control environments
* Partial failures during upgrade
* Mixed versions during rolling upgrades

---

## ğŸš¨ ABSOLUTE LANGUAGE RULES

### âœ… ALLOWED LANGUAGES

* **Shell (Bash) â€“ orchestration only**
* **Rust â€“ installer logic and validation**
* **Python â€“ ONLY for packaging helpers (NOT runtime)**

### âŒ FORBIDDEN LANGUAGES

* Java
* Go
* NodeJS
* Any installer requiring cloud connectivity
* Any interactive installer requiring assumptions

â¡ï¸ Installers must be **fully automatable and non-interactive**.

---

## ğŸš« LICENSE RULES (STRICT)

Allowed only:

* MIT
* BSD
* Apache 2.0
* System utilities available on target OS

BANNED:

* GPL installers bundled into binaries
* Unknown-license packaging tools

---

## ğŸ¯ PHASE 11 OBJECTIVE

Build a **unified, deterministic, safe installer and operations framework** that:

1. Installs all RansomEye components
2. Validates environment before installation
3. Supports **safe upgrades and rollbacks**
4. Enforces version compatibility
5. Works in **air-gapped environments**
6. Centralizes systemd / service management

---

## ğŸ“¦ INSTALLER RESPONSIBILITIES (STRICT)

### MUST DO

* Pre-flight validation
* Dependency checks
* Version compatibility checks
* Integrity verification (signatures, hashes)
* Atomic installation
* Safe rollback on failure
* Centralized service control
* Deterministic logging

### MUST NEVER DO

* Modify OS security posture silently
* Download from internet
* Assume distro-specific features
* Leave partial installs
* Proceed on validation failure

---

## ğŸ“ PHASE 11 FOLDER STRUCTURE (MANDATORY)

You MUST create and explain:

```
installers/
â”œâ”€â”€ unified/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main.rs
â”‚   â”‚   â”œâ”€â”€ preflight.rs
â”‚   â”‚   â”œâ”€â”€ verify.rs
â”‚   â”‚   â”œâ”€â”€ install.rs
â”‚   â”‚   â”œâ”€â”€ upgrade.rs
â”‚   â”‚   â”œâ”€â”€ rollback.rs
â”‚   â”‚   â””â”€â”€ logging.rs
â”‚   â”‚
â”‚   â”œâ”€â”€ packages/
â”‚   â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ dpi_probe/
â”‚   â”‚   â”œâ”€â”€ linux_agent/
â”‚   â”‚   â”œâ”€â”€ windows_agent/
â”‚   â”‚   â””â”€â”€ ai_models/
â”‚   â”‚
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ install_schema.md
â”‚   â”‚
â”‚   â””â”€â”€ errors/
â”‚       â””â”€â”€ installer_errors.rs
â”‚
â”œâ”€â”€ systemd/
â”‚   â”œâ”€â”€ ransomeye-core.service
â”‚   â”œâ”€â”€ ransomeye-dpi-probe.service
â”‚   â”œâ”€â”€ ransomeye-linux-agent.service
â”‚   â””â”€â”€ ransomeye-control-plane.service
â”‚
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ install.sh
â”‚   â”œâ”€â”€ upgrade.sh
â”‚   â”œâ”€â”€ rollback.sh
â”‚   â””â”€â”€ verify.sh
â”‚
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ installation_guide.md
â”‚   â”œâ”€â”€ upgrade_guide.md
â”‚   â”œâ”€â”€ rollback_guide.md
â”‚   â”œâ”€â”€ airgap_guide.md
â”‚   â””â”€â”€ failure_modes.md
â”‚
â””â”€â”€ tests/
    â”œâ”€â”€ preflight_tests.rs
    â”œâ”€â”€ upgrade_failure_tests.rs
    â”œâ”€â”€ rollback_tests.rs
    â””â”€â”€ version_mismatch_tests.rs
```

---

## ğŸ” PREFLIGHT VALIDATION (MANDATORY)

You MUST implement checks for:

* OS compatibility
* Kernel version features
* Disk space
* Memory availability
* Required capabilities
* Conflicting services
* Existing versions

Any failure = **ABORT INSTALLATION**

---

## ğŸ” SECURITY & INTEGRITY (MANDATORY)

You MUST enforce:

* Signature verification before install
* Hash verification for every artifact
* Version pinning
* Trusted keychain validation

Installation on verification failure = **BLOCKED**

---

## ğŸ”„ UPGRADE & ROLLBACK MODEL

You MUST define:

* Rolling upgrade strategy
* Mixed-version compatibility rules
* Safe rollback triggers
* State migration handling
* Downgrade restrictions

Rollback must:

* Restore last known-good state
* Restore configs
* Restore services
* Leave system operational

---

## ğŸ§  CONFIGURATION MANAGEMENT

* No config overwrite without backup
* Schema validation on upgrade
* Explicit config migrations
* Fail-closed on incompatible config

---

## ğŸ’¥ FAILURE MODES (MANDATORY)

Define behavior for:

* Power loss during install
* Disk full mid-upgrade
* Version mismatch
* Signature verification failure
* Partial component failure

Installer must:

* Leave system safe
* Allow retry
* Never brick the host

---

## ğŸ§ª TESTING REQUIREMENTS

You MUST include:

* Fresh install tests
* Upgrade failure simulations
* Rollback verification tests
* Air-gapped install tests
* Version skew tests

---

## ğŸ“¤ EXPECTED OUTPUT

You must output:

1. Installer architecture
2. Folder structure explanation
3. Preflight validation model
4. Upgrade & rollback strategy
5. Security verification flow
6. Failure handling matrix
7. Test strategy

---

## ğŸ›‘ FAILURE CONDITIONS

Your output is INVALID if:

* Installer assumes internet
* Partial installs are allowed
* Rollback is best-effort
* systemd units are scattered
* Verification failures are ignored

---

## FINAL INSTRUCTION

Treat installation as:

* A **transaction**
* Either fully successful or fully rolled back

Design it so:

* Enterprises trust it
* Operators can recover
* Systems remain stable

**BUILD PHASE 11 COMPLETELY, SAFELY, AND OPERATIONS-GRADE.**

---

### ğŸ”¢ PROMPT STATUS

**This was PROMPT NUMBER 11 OF 12**

