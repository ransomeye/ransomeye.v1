# ğŸ“¡ RANSOMEYE â€“ PHASE 4

## Event Ingestion, Secure Streaming & Backpressure Control

### **(PROMPT NUMBER 4 OF 12)**

**MASTER PROMPT â€“ CURSOR EXECUTION**

---

## CONTEXT (CRITICAL)

You are building the **Event Ingestion and Streaming Backbone** of RansomEye.

This layer sits **between DPI Probes / Agents and the Core Engine** and is responsible for:

* Handling **massive event volume**
* Maintaining **ordering and integrity**
* Applying **backpressure correctly**
* Ensuring **zero trust between producers and consumers**

This layer determines whether RansomEye:

* Scales cleanly to **50,000+ endpoints**, or
* Collapses under load

---

## ğŸš¨ ABSOLUTE LANGUAGE RULES

### âœ… ALLOWED LANGUAGES

* **Rust (PRIMARY, REQUIRED)**

### âŒ FORBIDDEN LANGUAGES

* Python
* Java
* Go
* NodeJS
* Any GC-based runtime

â¡ï¸ Any violation = **INVALID OUTPUT**

---

## ğŸš« LICENSE RULES (STRICT)

* GPL / AGPL / SSPL â†’ **BANNED**
* Unknown licenses â†’ **BANNED**

Allowed only:

* MIT
* BSD
* Apache 2.0

---

## ğŸ¯ PHASE 4 OBJECTIVE

Build a **secure, high-throughput, backpressure-aware ingestion layer** that:

1. Accepts events from:

   * DPI Probes
   * Linux Agents
   * Windows Agents
2. Authenticates every producer
3. Preserves integrity and ordering
4. Prevents overload propagation
5. Feeds the Core Engine deterministically

This layer **does not**:

* Make decisions
* Store long-term state
* Perform AI inference

---

## ğŸ“¦ RESPONSIBILITIES (STRICT)

### MUST DO

* Secure event intake
* Identity verification
* Rate control
* Backpressure signaling
* Event normalization
* Temporary buffering

### MUST NEVER DO

* Policy evaluation
* Correlation
* Persistence
* Trust producers implicitly

---

## ğŸ“ PHASE 4 FOLDER STRUCTURE (MANDATORY)

You MUST create and explain:

```
core/
â”œâ”€â”€ ingestion/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main.rs
â”‚   â”‚   â”œâ”€â”€ server.rs
â”‚   â”‚   â”œâ”€â”€ auth.rs
â”‚   â”‚   â”œâ”€â”€ rate_limit.rs
â”‚   â”‚   â”œâ”€â”€ backpressure.rs
â”‚   â”‚   â”œâ”€â”€ buffer.rs
â”‚   â”‚   â”œâ”€â”€ ordering.rs
â”‚   â”‚   â””â”€â”€ dispatcher.rs
â”‚   â”‚
â”‚   â”œâ”€â”€ protocol/
â”‚   â”‚   â”œâ”€â”€ event_schema.rs
â”‚   â”‚   â”œâ”€â”€ versioning.rs
â”‚   â”‚   â””â”€â”€ validation.rs
â”‚   â”‚
â”‚   â”œâ”€â”€ security/
â”‚   â”‚   â”œâ”€â”€ identity.rs
â”‚   â”‚   â”œâ”€â”€ signature.rs
â”‚   â”‚   â””â”€â”€ trust_enforcement.rs
â”‚   â”‚
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ validation.rs
â”‚   â”‚
â”‚   â””â”€â”€ errors/
â”‚       â””â”€â”€ ingest_errors.rs
â”‚
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ ingestion_flow.md
â”‚   â”œâ”€â”€ backpressure_model.md
â”‚   â”œâ”€â”€ trust_boundaries.md
â”‚   â””â”€â”€ failure_modes.md
â”‚
â””â”€â”€ tests/
    â”œâ”€â”€ synthetic_events.rs
    â”œâ”€â”€ overload_tests.rs
    â”œâ”€â”€ auth_failure_tests.rs
    â””â”€â”€ ordering_tests.rs
```

You MUST justify:

* Why each module exists
* What it enforces
* What it forbids

---

## ğŸ”€ EVENT FLOW (STEP-BY-STEP)

You MUST explicitly define:

1. Producer authentication
2. Event signature verification
3. Schema validation
4. Rate limiting
5. Buffering
6. Ordering guarantees
7. Dispatch to Core Engine

Each step must include:

* Input
* Output
* Failure behavior
* Backpressure behavior

---

## âš™ï¸ BACKPRESSURE MODEL (CRITICAL)

You MUST define:

* Producer throttling
* Buffer limits
* Drop policy (if any)
* Feedback mechanism to DPI/Agents
* Recovery behavior

ğŸš« NO silent drops allowed.

---

## ğŸ” SECURITY ENFORCEMENT

Mandatory:

* Mutual authentication
* Signature verification
* Replay protection
* Version compatibility checks
* Fail-closed behavior

---

## ğŸ’¥ FAILURE MODES (REQUIRED)

Define behavior for:

* Producer flooding
* Invalid signatures
* Schema mismatch
* Buffer exhaustion
* Core Engine unavailability
* Network partitions

All failures must be:

* Explicit
* Logged
* Observable
* Fail-safe

---

## ğŸ§ª TESTING REQUIREMENTS

You MUST include:

* Synthetic event generators
* High-rate ingestion tests
* Backpressure stress tests
* Identity spoofing attempts
* Replay attack tests

No production data.

---

## ğŸ“¤ EXPECTED OUTPUT

You must output:

1. Ingestion architecture explanation
2. Folder structure explanation
3. Event flow walkthrough
4. Backpressure model
5. Security enforcement
6. Failure handling matrix
7. Test strategy

---

## ğŸ›‘ FAILURE CONDITIONS

Your output is INVALID if:

* Python appears anywhere
* Events bypass authentication
* Backpressure is vague
* Silent drops exist
* Ordering is undefined
* Trust is implicit

---

## FINAL INSTRUCTION

This ingestion layer is the **shock absorber** of RansomEye.

Design it as if:

* Producers misbehave
* Traffic spikes unpredictably
* Attackers attempt flooding

**BUILD PHASE 4 COMPLETELY AND STRICTLY.**

---

### ğŸ”¢ PROMPT STATUS

**This was PROMPT NUMBER 4 OF 12**

When ready, say **â€œProceed to next promptâ€** and I will deliver **PROMPT NUMBER 5 OF 12**.
