# ğŸ§ RANSOMEYE â€“ PHASE 9A

## Linux Agent (Stand-Alone Module)

### **(PROMPT NUMBER 9A OF 12)**

**MASTER PROMPT â€“ CURSOR EXECUTION**

---

## CONTEXT (STAND-ALONE MODULE â€“ CRITICAL)

You are building the **RansomEye Linux Agent**.

This agent is a **stand-alone deployable module**, independently installable, upgradeable, and removable.

The Linux Agent must:

* Run on **ANY Linux distribution**
* Run on **ANY kernel version (within reason)**
* Have **ZERO runtime dependency on Python**
* Be **static where possible**
* Be **fail-closed**
* Operate in **hostile and air-gapped environments**

This agent operates at the **endpoint trust boundary**.

---

## ğŸš¨ ABSOLUTE LANGUAGE RULES

### âœ… ALLOWED LANGUAGES

* **Rust (MANDATORY, PRIMARY)**
* **C (ONLY for kernel / low-level helpers if unavoidable)**

### âŒ FORBIDDEN LANGUAGES

* Python
* Java
* Go
* NodeJS
* Shell scripts as core logic
* Any interpreter-based runtime

â¡ï¸ Any violation = **INVALID OUTPUT**

---

## ğŸš« LICENSE RULES (STRICT)

Allowed only:

* MIT
* BSD
* Apache 2.0

BANNED:

* GPL / AGPL / SSPL
* eBPF userland GPL leakage
* Unknown-license libraries

Kernel GPL is acceptable **only inside kernel**, never in userland binaries.

---

## ğŸ¯ PHASE 9A OBJECTIVE

Build a **minimal-footprint, high-integrity Linux Agent** that:

1. Collects host telemetry
2. Detects suspicious local behavior
3. Executes enforcement actions **only when instructed**
4. Maintains cryptographic identity
5. Operates offline safely
6. Degrades gracefully on unsupported kernels

---

## ğŸ“¦ LINUX AGENT RESPONSIBILITIES (STRICT)

### MUST DO

* Process monitoring
* File activity monitoring
* System integrity signals
* Kernel / OS metadata collection
* Secure communication with Core
* Local enforcement execution
* Self-integrity verification

### MUST NEVER DO

* Correlate multi-host data
* Train ML models
* Make autonomous policy decisions
* Trust unsigned commands
* Require specific Linux distros

---

## ğŸ“ PHASE 9A FOLDER STRUCTURE (MANDATORY)

You MUST create and explain:

```
agents/
â””â”€â”€ linux/
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ main.rs
    â”‚   â”œâ”€â”€ agent.rs
    â”‚   â”œâ”€â”€ lifecycle.rs
    â”‚   â”œâ”€â”€ telemetry/
    â”‚   â”‚   â”œâ”€â”€ mod.rs
    â”‚   â”‚   â”œâ”€â”€ process.rs
    â”‚   â”‚   â”œâ”€â”€ filesystem.rs
    â”‚   â”‚   â”œâ”€â”€ memory.rs
    â”‚   â”‚   â””â”€â”€ kernel.rs
    â”‚   â”‚
    â”‚   â”œâ”€â”€ enforcement/
    â”‚   â”‚   â”œâ”€â”€ mod.rs
    â”‚   â”‚   â”œâ”€â”€ actions.rs
    â”‚   â”‚   â””â”€â”€ safeguards.rs
    â”‚   â”‚
    â”‚   â”œâ”€â”€ security/
    â”‚   â”‚   â”œâ”€â”€ identity.rs
    â”‚   â”‚   â”œâ”€â”€ verification.rs
    â”‚   â”‚   â””â”€â”€ integrity.rs
    â”‚   â”‚
    â”‚   â”œâ”€â”€ comms/
    â”‚   â”‚   â”œâ”€â”€ protocol.rs
    â”‚   â”‚   â”œâ”€â”€ encryption.rs
    â”‚   â”‚   â””â”€â”€ retry.rs
    â”‚   â”‚
    â”‚   â”œâ”€â”€ config/
    â”‚   â”‚   â””â”€â”€ validation.rs
    â”‚   â”‚
    â”‚   â””â”€â”€ errors/
    â”‚       â””â”€â”€ agent_errors.rs
    â”‚
    â”œâ”€â”€ systemd/
    â”‚   â””â”€â”€ ransomeye-linux-agent.service
    â”‚
    â”œâ”€â”€ docs/
    â”‚   â”œâ”€â”€ telemetry_model.md
    â”‚   â”œâ”€â”€ enforcement_model.md
    â”‚   â”œâ”€â”€ kernel_compatibility.md
    â”‚   â”œâ”€â”€ failure_modes.md
    â”‚   â””â”€â”€ security_model.md
    â”‚
    â””â”€â”€ tests/
        â”œâ”€â”€ synthetic_telemetry.rs
        â”œâ”€â”€ enforcement_tests.rs
        â”œâ”€â”€ tamper_tests.rs
        â””â”€â”€ recovery_tests.rs
```

---

## ğŸ” IDENTITY & TRUST (MANDATORY)

You MUST:

* Generate a unique cryptographic identity per agent
* Enroll via secure bootstrap
* Verify every command signature
* Reject expired or revoked identities
* Fail closed on verification failure

---

## âš™ï¸ TELEMETRY MODEL

You MUST define:

* Telemetry types
* Sampling strategy
* Rate limits
* Backpressure handling
* Privacy boundaries

No raw file contents.
No credential collection.

---

## ğŸ›¡ï¸ ENFORCEMENT MODEL (STRICT)

Enforcement actions:

* Must be explicit
* Must be signed
* Must be scoped
* Must be reversible
* Must be auditable

Agent must **refuse**:

* Unsigned actions
* Ambiguous commands
* Over-broad scopes

---

## ğŸ’¥ FAILURE MODES (MANDATORY)

Define behavior for:

* Kernel feature unavailable
* Permission loss
* Disk full
* Network isolation
* Identity expiration
* Binary tampering

Agent must:

* Remain observable
* Avoid crashing
* Avoid blocking host OS

---

## ğŸ§ª TESTING REQUIREMENTS

You MUST include:

* Synthetic telemetry generation
* Enforcement safety tests
* Tamper detection tests
* Kernel compatibility tests
* Offline operation tests

---

## ğŸ“¤ EXPECTED OUTPUT

You must output:

1. Linux Agent architecture
2. Folder structure explanation
3. Telemetry model
4. Enforcement safeguards
5. Identity & trust flow
6. Failure handling matrix
7. Test strategy

---

## ğŸ›‘ FAILURE CONDITIONS

Your output is INVALID if:

* Python is used
* Distro assumptions exist
* Enforcement is implicit
* Commands are unsigned
* Agent trusts Core blindly

---

## FINAL INSTRUCTION

Treat the Linux Agent as:

* Hostile-environment software
* Minimal attack surface
* High-trust, low-authority component

Design it to survive:

* Kernel differences
* Operator mistakes
* Partial compromise

**BUILD PHASE 9A COMPLETELY AND STRICTLY.**

---

### ğŸ”¢ PROMPT STATUS

**This was PROMPT NUMBER 9A OF 12**
