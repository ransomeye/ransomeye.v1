# Path and File Name : /home/ransomeye/rebuild/core/response_playbooks/playbooks/ransomware_isolation.yaml
# Author: nXxBku0CKFAJCBN3X1g3bQk7OxYQylg8CMw1iGsq7gU
# Details of functionality of this file: Example signed playbook for ransomware isolation response

id: 550e8400-e29b-41d4-a716-446655440001
name: Ransomware Isolation Response
version: 1.0.0
severity: critical
trigger_conditions:
  policy_outcomes:
    - deny
    - quarantine
  alert_severity:
    - critical
    - high
  kill_chain_stage:
    - actions_on_objectives
    - command_and_control
  custom_conditions:
    threat_type: ransomware
steps:
  - step_id: step_00000001
    step_name: Isolate Affected Host
    action_type: isolate
    enforcement_action:
      adapter: linux_agent
      parameters:
        host_id: "${HOST_ID}"
        isolation_level: full
    timeout_seconds: 30
    retry_on_failure: true
    continue_on_failure: false
    preconditions:
      - host_identified
    postconditions:
      - host_isolated
  - step_id: step_00000002
    step_name: Block Network Communication
    action_type: block
    enforcement_action:
      adapter: network
      parameters:
        host_id: "${HOST_ID}"
        block_direction: both
    timeout_seconds: 15
    retry_on_failure: true
    continue_on_failure: false
    preconditions:
      - host_isolated
    postconditions:
      - network_blocked
  - step_id: step_00000003
    step_name: Collect Forensic Evidence
    action_type: collect
    enforcement_action:
      adapter: core
      parameters:
        host_id: "${HOST_ID}"
        evidence_types:
          - memory
          - disk
          - network_logs
    timeout_seconds: 300
    retry_on_failure: false
    continue_on_failure: true
    preconditions:
      - network_blocked
    postconditions:
      - evidence_collected
  - step_id: step_00000004
    step_name: Notify Security Team
    action_type: notify
    enforcement_action:
      adapter: core
      parameters:
        notification_level: critical
        recipients:
          - security@ransomeye.tech
    timeout_seconds: 10
    retry_on_failure: true
    continue_on_failure: true
    preconditions: []
    postconditions:
      - team_notified
rollback_steps:
  - rollback_id: rollback_0001
    rollback_name: Restore Network Communication
    reverse_action:
      adapter: network
      parameters:
        host_id: "${HOST_ID}"
        action: unblock
    timeout_seconds: 15
  - rollback_id: rollback_0002
    rollback_name: Remove Host Isolation
    reverse_action:
      adapter: linux_agent
      parameters:
        host_id: "${HOST_ID}"
        action: unisolate
    timeout_seconds: 30
approvals_required:
  human_approval: true
  auto_approval: false
  approval_timeout_seconds: 300
dry_run_supported: true
timeout_per_step: 60
max_execution_time: 3600
signature: "dGVzdF9zaWduYXR1cmVfZm9yX3JhbnNvbXdhcmVfaXNvbGF0aW9uX3BsYXlib29rX3RoaXNfaXNfYV9wbGFjZWhvbGRlcl9hbmRfd291bGRfYmVfcmVwbGFjZWRfd2l0aF9yZWFsX2NyeXB0b2dyYXBoaWNfc2lnbmF0dXJlX2luX3Byb2R1Y3Rpb24="
signature_hash: "a1b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef123456"
metadata:
  created_at: "2025-01-27T00:00:00Z"
  created_by: "system"
  description: "Isolates and contains ransomware-infected hosts"
  tags:
    - ransomware
    - isolation
    - critical

