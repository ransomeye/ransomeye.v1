# Path and File Name : /home/ransomeye/rebuild/core/response_playbooks/playbooks/malware_quarantine.yaml
# Author: nXxBku0CKFAJCBN3X1g3bQk7OxYQylg8CMw1iGsq7gU
# Details of functionality of this file: Example signed playbook for malware quarantine response

id: 550e8400-e29b-41d4-a716-446655440002
name: Malware Quarantine Response
version: 1.0.0
severity: high
trigger_conditions:
  policy_outcomes:
    - quarantine
  alert_severity:
    - high
    - medium
  kill_chain_stage:
    - exploitation
    - installation
  custom_conditions:
    threat_type: malware
steps:
  - step_id: step_00000001
    step_name: Quarantine File
    action_type: quarantine
    enforcement_action:
      adapter: linux_agent
      parameters:
        file_path: "${FILE_PATH}"
        quarantine_location: "/var/quarantine"
    timeout_seconds: 20
    retry_on_failure: true
    continue_on_failure: false
    preconditions:
      - file_identified
    postconditions:
      - file_quarantined
  - step_id: step_00000002
    step_name: Analyze Quarantined File
    action_type: analyze
    enforcement_action:
      adapter: core
      parameters:
        file_path: "${FILE_PATH}"
        analysis_types:
          - static
          - dynamic
    timeout_seconds: 180
    retry_on_failure: false
    continue_on_failure: true
    preconditions:
      - file_quarantined
    postconditions:
      - analysis_complete
  - step_id: step_00000003
    step_name: Notify Security Team
    action_type: notify
    enforcement_action:
      adapter: core
      parameters:
        notification_level: high
        recipients:
          - security@ransomeye.tech
    timeout_seconds: 10
    retry_on_failure: true
    continue_on_failure: true
    preconditions: []
    postconditions:
      - team_notified
rollback_steps:
  - rollback_id: rollback_0001
    rollback_name: Restore Quarantined File
    reverse_action:
      adapter: linux_agent
      parameters:
        file_path: "${FILE_PATH}"
        action: restore
    timeout_seconds: 20
approvals_required:
  human_approval: false
  auto_approval: true
dry_run_supported: true
timeout_per_step: 60
max_execution_time: 1800
signature: "dGVzdF9zaWduYXR1cmVfZm9yX21hbHdhcmVfcXVhcmFudGluZV9wbGF5Ym9va19wbGFjZWhvbGRlcg=="
signature_hash: "b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef12345678"
metadata:
  created_at: "2025-01-27T00:00:00Z"
  created_by: "system"
  description: "Quarantines and analyzes malware files"
  tags:
    - malware
    - quarantine
    - high

